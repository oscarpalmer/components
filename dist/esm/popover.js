var y=Object.defineProperty;var k=(i,e,t)=>e in i?y(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var g=(i,e,t)=>(k(i,typeof e!="symbol"?e+"":e,t),t);var f={active:{capture:!1,passive:!1},passive:{capture:!1,passive:!0}},w=["[href]","[tabindex]","button","input","select","textarea"].map(i=>`${i}:not([disabled]):not([hidden]):not([tabindex="-1"])`).join(",");function u(i){return requestAnimationFrame?.(i)??setTimeout?.(()=>{i(Date.now())},16)}function v(i){let e=[],t=Array.from(i.querySelectorAll(w));for(let n of t){let o=window?.getComputedStyle?.(n);(o==null||o.display!=="none"&&o.visibility!=="hidden")&&e.push(n)}return e}function E(){return URL.createObjectURL(new Blob).replace(/^.*\/([\w-]+)$/,"$1").replace(/-/g,"_")}var d=class{static setCoordinate(e,t){let{left:n,top:o}=t;e.style.inset="0 auto auto 0",e.style.position="fixed",e.style.transform=`translate3d(${n}px, ${o}px, 0)`,e.hidden&&u(()=>{e.hidden=!1})}static update(e,t,n,o){let{anchor:l,floater:r,parent:s}=e;function m(){if(o())return;let h=d.getPosition(s??l,t);r.setAttribute("position",h);let b=n(h,{anchor:l.getBoundingClientRect(),floater:r.getBoundingClientRect(),parent:s?.getBoundingClientRect()});d.setCoordinate(r,b),u(m)}u(m)}static getPosition(e,t){let o=e.getAttribute("position")?.trim().toLowerCase();return o!=null&&t.all.includes(o)?o:t.default}};var M=["any"].concat(...["above","below"].map(i=>[i,`${i}-left`,`${i}-right`])),a=class{static getCoordinate(e,t){return{left:a.getLeft(e,t),top:a.getTop(e,t)}}static getLeft(e,t){let{left:n,right:o}=t.anchor,{width:l}=t.floater,r=n+l,s=o-l;return e.includes("left")||e.includes("right")?e.includes("left")?n:o-l:r>window.innerWidth?s<0?n:o-l:n}static getTop(e,t){let{bottom:n,top:o}=t.anchor,{height:l}=t.floater,r=n+l,s=o-l;return e.includes("above")||e.includes("below")?e.includes("above")?o-l:n:r>window.innerHeight?s<0?n:s:n}static onClick(e){if(!(this instanceof p))return;let{anchor:t,floater:n}=c.getElements(this);t==null||n==null||t.getAttribute("aria-expanded")!=="true"||e.target!==t&&e.target!==n&&!(n?.contains(e.target)??!1)&&a.toggle.call(this,!1)}static onKeydown(e){if(!(this instanceof p)||!(e instanceof KeyboardEvent))return;let{anchor:t,floater:n}=c.getElements(this);if(t==null||n==null||t.getAttribute("aria-expanded")!=="true"||(e.key==="Escape"&&a.toggle.call(this,!1),e.key!=="Tab"))return;e.preventDefault();let o=v(n);if(document.activeElement===n){u(()=>{(o[e.shiftKey?o.length-1:0]??n).focus()});return}let l=o.indexOf(document.activeElement),r=n;if(l>-1){let s=l+(e.shiftKey?-1:1);s<0?s=o.length-1:s>=o.length&&(s=0),r=o[s]??n}u(()=>{r.focus()})}static toggle(e){if(!(this instanceof p))return;let{anchor:t,floater:n}=c.getElements(this);if(t==null||n==null)return;let o=typeof e=="boolean"?!e:t.getAttribute("aria-expanded")==="true",{click:l,keydown:r}=c.getCallbacks(this),s=o?"removeEventListener":"addEventListener";l!=null&&document[s]("click",l,f.passive),r!=null&&document[s]("keydown",r,f.active),o?n.parentElement?.removeChild(n):document.body.appendChild(n),t.setAttribute("aria-expanded",String(!o)),(o?t:v(n)[0]??n).focus(),d.update({anchor:t,floater:n,parent:this},{all:M,default:"below"},a.getCoordinate,()=>t.getAttribute("aria-expanded")!=="true")}},c=class{static getCallbacks(e){return{click:this.values.click.get(e),keydown:this.values.keydown.get(e)}}static getElements(e){return{anchor:this.values.anchors.get(e),floater:this.values.floaters.get(e)}}static remove(e){this.values.anchors.delete(e),this.values.click.delete(e),this.values.floaters.delete(e),this.values.keydown.delete(e)}static setCallbacks(e){this.values.click?.set(e,a.onClick.bind(e)),this.values.keydown?.set(e,a.onKeydown.bind(e))}static setElements(e,t,n){this.values.anchors?.set(e,t),this.values.floaters?.set(e,n)}};g(c,"values",{anchors:new WeakMap,click:new WeakMap,floaters:new WeakMap,keydown:new WeakMap});var p=class extends HTMLElement{close(){a.toggle.call(this,!1)}connectedCallback(){let e=this.querySelector(":scope > [polite-popover-button]"),t=this.querySelector(":scope > [polite-popover-content]");if(e==null)throw new Error("a");if(!(e instanceof HTMLButtonElement)&&e.getAttribute("role")!=="button")throw new Error("b");if(t==null)throw new Error("c");t.parentElement?.removeChild(t),t.id||t.setAttribute("id",E()),d.setCoordinate(t,{left:-1e6,top:-1e6}),e.setAttribute("aria-controls",t.id),e.setAttribute("aria-expanded","false"),t.setAttribute("tabindex","-1"),c.setElements(this,e,t),c.setCallbacks(this),e.addEventListener("click",a.toggle.bind(this),f.passive)}disconnectedCallback(){c.remove(this)}open(){a.toggle.call(this,!0)}toggle(){a.toggle.call(this)}};customElements?.define("polite-popover",p);
