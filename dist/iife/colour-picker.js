(()=>{function m(t){if(t instanceof MouseEvent)return{x:t.clientX,y:t.clientY};let e=t.touches[0]?.clientX,n=t.touches[0]?.clientY;return typeof e=="number"&&typeof n=="number"?{x:e,y:n}:void 0}function a(t,e){return{capture:e??!1,passive:t??!0}}var c=(()=>{let t=!1;try{if("matchMedia"in window){let e=matchMedia("(pointer: coarse)");typeof e?.matches=="boolean"&&(t=e.matches)}t||(t="ontouchstart"in window||navigator.maxTouchPoints>0||(navigator.msMaxTouchPoints??0)>0)}catch{t=!1}return t})(),d={begin:c?"touchstart":"mousedown",end:c?"touchend":"mouseup",move:c?"touchmove":"mousemove"};var L=/^arrow(?:(down)|(left)|(right)|(up))/i,P=["linear-gradient(to bottom","hsl(0 0% 100%) 0%","hsl(0 0% 100% / 0) 50%","hsl(0 0% 0% / 0) 50%","hsl(0 0% 0%) 100%)","linear-gradient(to right","hsl(0 0% 50%) 0%","hsl(0 0% 50% / 0) 100%)"],S=/^([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i,K=/^([\da-f]{3}){1,2}$/i,g=new WeakMap,u="palmer-colour-picker";function C(t,e){t.hidden=!1,e.type="range",e.max=360,e.min=0}function D(t,e){t.hidden=!1,t.style.backgroundColor="hsl(var(--hue-value) 100% 50%)",t.style.backgroundImage=P,t.style.position="relative",e.tabIndex=0,e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.transform="translate3d(-50%, -50%, 0)"}function x(t,e){let n=E(t);return N(n)?(n.length===3&&(n=n.split("").map(s=>`${s}${s}`).join("")),n):e}function M(t){let e=x(t);if(e===void 0)return;let n=e.match(S),s=[];for(let o=0;o<3;o+=1)s.push(Number.parseInt(n[o+1],16));return{red:s[0],green:s[1],blue:s[2]}}function $(t){function e(i){let r=(i+n/30)%12,l=s*Math.min(o,1-o);return o-l*Math.max(-1,Math.min(r-3,9-r,1))}let{hue:n,saturation:s,lightness:o}=t;return n%=360,n<0&&(n+=360),s/=100,o/=100,{red:Math.round(e(0)*255),green:Math.round(e(8)*255),blue:Math.round(e(4)*255)}}function E(t){return t?.replace(/^(#|\s)|\s$/g,"")??""}function q(t){t.key==="Escape"&&(t.stopPropagation(),I(this,!0))}function W(){I(this,!1)}function b(t){c&&t.preventDefault();let{height:e,left:n,top:s,width:o}=this.well.getBoundingClientRect(),{x:i,y:r}=m(t),l=100-Math.round((r-s)/e*100),h=Math.round((i-n)/o*100);H(this,h,l)}function A(){this.hsl.hue=Number.parseInt(this.hueInput.value,10),f(this)}function O(t){if(t.key!=="Enter")return;t.preventDefault();let e=M(this.input.value);if(e===void 0)return;let n=k(e);this.hsl.hue=n.hue,this.hsl.saturation=n.saturation,this.hsl.lightness=n.lightness,f(this)}function R(t){let e=L.exec(t.key);if(e===null)return;t.preventDefault();let{lightness:n,saturation:s}=this.hsl;n+=e[1]?-1:e[4]?1:0,s+=e[2]?-1:e[3]?1:0,H(this,s,n)}function w(t){if(t.altKey||t.ctrlKey||t.metaKey||t.shiftKey||t.button>0)return;t.stopPropagation(),b.call(this,t);let e={callbacks:{onKeydown:q.bind(this),onPointerEnd:W.bind(this),onPointerMove:b.bind(this)},hsl:{hue:this.hsl.hue,saturation:this.hsl.saturation,lightness:this.hsl.lightness}};T(e.callbacks,!0),g.set(this,e)}function v(t){return`#${(t.blue|t.green<<8|t.red<<16|1<<24).toString(16).slice(1)}`}function k(t){let{red:e,green:n,blue:s}=t;e/=255,n/=255,s/=255;let o=Math.min(e,n,s),i=Math.max(e,n,s),r=i-o,l=i-r/2,h=0,y=0;switch(r){case e:{h=(n-s)/r%6;break}case n:{h=(s-e)/r+2;break}case s:{h=(e-n)/r+2;break}default:break}return y=i===0||l===0||l===0?0:(i-l)/Math.min(l,1-l),h*=60,h<0&&(h+=360),{hue:Math.round(h),saturation:Math.round(y*100),lightness:Math.round(l*100)}}function T(t,e){let n=e?document.addEventListener:document.removeEventListener;n("keydown",t.onKeydown,a(!0,!0)),n(d.end,t.onPointerEnd,a()),n(d.move,t.onPointerMove,a(!c)),B(e)}function B(t){document.body.style.userSelect=t?"none":null,document.body.style.webkitUserSelect=t?"none":null}function H(t,e,n){t.hsl.saturation=e<0?0:e>100?100:e,t.hsl.lightness=n<0?0:n>100?100:n,f(t)}function I(t,e){let n=g.get(t);n!==void 0&&(T(n.callbacks,!1),e&&(t.hsl.hue=n.hsl.hue,t.hsl.lightness=n.hsl.lightness,t.hsl.saturation=n.hsl.saturation,f(t)),g.delete(t),t.wellHandle.focus())}function N(t){return K.test(E(t))}function f(t){let{hsl:e,hueInput:n,input:s}=t;n.value=e.hue,V(t),X(t),s.value=v($(e)),s.dispatchEvent(new Event("change"))}function V(t){let{hue:e,lightness:n,saturation:s}=t.hsl,o=`${e/360*100}%`,i=`hsl(${e} ${s}% ${n}%)`;for(let r of[t,t.hue,t.well])r.style.setProperty("--hue-handle",o),r.style.setProperty("--hue-value",e),r.style.setProperty("--value",i)}function X(t){let{hsl:e,wellHandle:n}=t;n.style.top=`${100-e.lightness}%`,n.style.left=`${e.saturation}%`}var p=class extends HTMLElement{get value(){let e=$(this.hsl);return{rgb:e,hex:v(e),hsl:this.hsl}}constructor(){super();let e=this.querySelector(`[${u}-hue]`),n=e?.querySelector(`[${u}-hue-input]`);if(!(e instanceof HTMLElement))throw new TypeError(`<${u}> needs an element with the attribute '${u}-hue' to hold the hue input`);if(!(n instanceof HTMLInputElement))throw new TypeError(`<${u}> needs an <input>-element with the attribute '${u}-hue-input'`);let s=this.querySelector(`[${u}-input]`);if(!(s instanceof HTMLInputElement)||!/^(color|text)$/i.test(s.type))throw new TypeError(`<${u}> needs an <input>-element with the attribute '${u}-input'`);let o=this.querySelector(`[${u}-well]`),i=o?.querySelector(`[${u}-well-handle]`);if([o,i].some(h=>!(h instanceof HTMLElement)))throw new TypeError(`<${u}> needs two elements for the colour well: one wrapping element with the attribute '${u}-well', and one within it with the attribute '${u}-well-handle'`);this.hue=e,this.hueInput=n,this.input=s,this.well=o,this.wellHandle=i,s.pattern="#?([\\da-fA-F]{3}){1,2}",s.type="text";let r=x(s.getAttribute("value")??this.getAttribute("value"),"000000"),l=M(r);this.hsl=k(l),C(e,n),D(o,i),s.addEventListener("keydown",O.bind(this),a(!1)),i.addEventListener("keydown",R.bind(this),a(!1)),i.addEventListener(d.begin,w.bind(this),a()),o.addEventListener(d.begin,w.bind(this),a()),n.addEventListener("input",A.bind(this),a()),f(this)}};customElements.define(u,p);})();
