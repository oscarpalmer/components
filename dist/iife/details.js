(()=>{var a=Math.round(16.666666666666668),d=globalThis.requestAnimationFrame??function(e){return setTimeout?.(()=>{e(Date.now())},a)};function p(e){e.state.active=!0,e.state.finished=!1;let t=e instanceof b,s=0,n;function o(r){if(!e.state.active)return;n??(n=r);let h=r-n,g=h-a,y=h+a;if(g<e.configuration.time&&e.configuration.time<y)if(e.state.active&&e.callbacks.default(t?s:void 0),s+=1,t&&s<e.configuration.count)n=void 0;else{e.state.finished=!0,e.stop();return}e.state.frame=d(o)}e.state.frame=d(o)}var m=class{get active(){return this.state.active}get finished(){return!this.active&&this.state.finished}constructor(e,t,s,n){let o=this instanceof b,r=o?"repeated":"waited";if(typeof e!="function")throw new TypeError(`A ${r} timer must have a callback function`);if(typeof t!="number"||t<0)throw new TypeError(`A ${r} timer must have a non-negative number as its time`);if(o&&(typeof s!="number"||s<2))throw new TypeError("A repeated timer must have a number above 1 as its repeat count");if(o&&n!==void 0&&typeof n!="function")throw new TypeError("A repeated timer's after-callback must be a function");this.configuration={count:s,time:t},this.callbacks={after:n,default:e},this.state={active:!1,finished:!1,frame:null}}restart(){return this.stop(),p(this),this}start(){return this.state.active||p(this),this}stop(){return this.state.active=!1,this.state.frame===void 0?this:((globalThis.cancelAnimationFrame??clearTimeout)?.(this.state.frame),this.callbacks.after?.(this.finished),this.state.frame=void 0,this)}},b=class extends m{},v=class extends m{constructor(e,t){super(e,t,1,null)}};function c(e,t){return new v(e,t).start()}var l={active:{capture:!1,passive:!1},passive:{capture:!1,passive:!0}};var i="palmer-details",u=new WeakMap;function T(e){u.has(e)||u.set(e,new f(e))}function w(e){u.delete(e)}function x(e){for(let t of e)if(t.type==="attributes"){if(!(t.target instanceof HTMLDetailsElement))throw new TypeError(`An element with the '${i}'-attribute must be a <details>-element`);t.target.getAttribute(i)===null?w(t.target):T(t.target)}}var f=class{constructor(t){this.details=t,this.summary=t.querySelector(":scope > summary")??void 0,this.callbacks={onKeydown:this.onKeydown.bind(this),onToggle:this.onToggle.bind(this)},this.details.addEventListener("toggle",this.callbacks.onToggle,l.passive)}onKeydown(t){t.key!=="Escape"||!this.details.open||[...this.details.querySelectorAll(`[${i}][open]`)].some(n=>n.contains(globalThis.document.activeElement))||!this.details.contains(globalThis.document.activeElement)||(this.details.open=!1,c(()=>this.summary?.focus(),0))}onToggle(){globalThis.document[this.details.open?"addEventListener":"removeEventListener"]?.("keydown",this.callbacks.onKeydown,l.passive)}},_=new MutationObserver(x);_.observe(globalThis.document,{attributeFilter:[i],attributeOldValue:!0,attributes:!0,childList:!0,subtree:!0});c(()=>{let e=Array.from(globalThis.document.querySelectorAll(`[${i}]`));for(let t of e)t.setAttribute(i,"")},0);})();
