(()=>{var a=Math.round(16.666666666666668),d=requestAnimationFrame??function(t){return setTimeout?.(()=>{t(Date.now())},a)};function p(t){t.state.active=!0,t.state.finished=!1;let e=t instanceof b,s=0,n;function r(o){if(!t.state.active)return;n??(n=o);let h=o-n,g=h-a,v=h+a;if(g<t.configuration.time&&t.configuration.time<v)if(t.state.active&&t.callbacks.default(e?s:void 0),s+=1,e&&s<t.configuration.count)n=void 0;else{t.state.finished=!0,t.stop();return}t.state.frame=d(r)}t.state.frame=d(r)}var m=class{get active(){return this.state.active}get finished(){return!this.active&&this.state.finished}constructor(t,e,s,n){let r=this instanceof b,o=r?"repeated":"waited";if(typeof t!="function")throw new TypeError(`A ${o} timer must have a callback function`);if(typeof e!="number"||e<0)throw new TypeError(`A ${o} timer must have a non-negative number as its time`);if(r&&(typeof s!="number"||s<2))throw new TypeError("A repeated timer must have a number above 1 as its repeat count");if(r&&n!==void 0&&typeof n!="function")throw new TypeError("A repeated timer's after-callback must be a function");this.configuration={count:s,time:e},this.callbacks={after:n,default:t},this.state={active:!1,finished:!1,frame:null}}restart(){return this.stop(),p(this),this}start(){return this.state.active||p(this),this}stop(){return this.state.active=!1,this.state.frame===void 0?this:((cancelAnimationFrame??clearTimeout)?.(this.state.frame),this.callbacks.after?.(this.finished),this.state.frame=void 0,this)}},b=class extends m{},y=class extends m{constructor(t,e){super(t,e,1,null)}};function c(t,e){return new y(t,e).start()}var u={active:{capture:!1,passive:!1},passive:{capture:!1,passive:!0}};var i="palmer-details",l=new WeakMap;function w(t){l.has(t)||l.set(t,new f(t))}function T(t){l.delete(t)}function E(t){for(let e of t)if(e.type==="attributes"){if(!(e.target instanceof HTMLDetailsElement))throw new TypeError(`An element with the '${i}'-attribute must be a <details>-element`);e.target.getAttribute(i)===null?T(e.target):w(e.target)}}var f=class{constructor(e){this.details=e,this.summary=e.querySelector(":scope > summary")??void 0,this.callbacks={onKeydown:this.onKeydown.bind(this),onToggle:this.onToggle.bind(this)},this.details.addEventListener("toggle",this.callbacks.onToggle,u.passive)}onKeydown(e){e.key!=="Escape"||!this.details.open||[...this.details.querySelectorAll(`[${i}][open]`)].some(n=>n.contains(globalThis.document.activeElement))||!this.details.contains(globalThis.document.activeElement)||(this.details.open=!1,c(()=>this.summary?.focus(),0))}onToggle(){globalThis.document[this.details.open?"addEventListener":"removeEventListener"]?.("keydown",this.callbacks.onKeydown,u.passive)}},x=new MutationObserver(E);x.observe(globalThis.document,{attributeFilter:[i],attributeOldValue:!0,attributes:!0,childList:!0,subtree:!0});c(()=>{let t=Array.from(globalThis.document.querySelectorAll(`[${i}]`));for(let e of t)e.setAttribute(i,"")},0);})();
