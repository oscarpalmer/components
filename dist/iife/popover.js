"use strict";(()=>{var V=Object.defineProperty;var W=(t,e,o)=>e in t?V(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var l=(t,e,o)=>(W(t,typeof e!="symbol"?e+"":e,o),o);var T=Math.round(16.666666666666668),O=requestAnimationFrame!=null?requestAnimationFrame:function(t){var e;return(e=setTimeout==null?void 0:setTimeout(()=>{t(Date.now())},T))!=null?e:-1},p=class{constructor(t,e,o,n){l(this,"callbacks");l(this,"configuration");l(this,"state",{active:!1,finished:!1});let i=this instanceof x,r=i?"repeated":"waited";if(typeof t!="function")throw new Error(`A ${r} timer must have a callback function`);if(typeof e!="number"||e<0)throw new Error(`A ${r} timer must have a non-negative number as its time`);if(i&&(typeof o!="number"||o<2))throw new Error("A repeated timer must have a number above 1 as its repeat count");if(i&&n!=null&&typeof n!="function")throw new Error("A repeated timer's after-callback must be a function");this.configuration={count:o,time:e},this.callbacks={after:n,default:t}}get active(){return this.state.active}get finished(){return!this.state.active&&this.state.finished}static run(t){t.state.active=!0,t.state.finished=!1;let e=t instanceof x,o=0,n;function i(r){if(!t.state.active)return;n!=null||(n=r);let s=r-n,a=s-T,c=s+T;if(a<t.configuration.time&&t.configuration.time<c)if(t.state.active&&t.callbacks.default(e?o:void 0),o+=1,e&&o<t.configuration.count)n=void 0;else{t.state.finished=!0,t.stop();return}t.state.frame=O(i)}t.state.frame=O(i)}restart(){return this.stop(),p.run(this),this}start(){return this.state.active||p.run(this),this}stop(){var t,e,o;return this.state.active=!1,typeof this.state.frame=="undefined"?this:((t=cancelAnimationFrame!=null?cancelAnimationFrame:clearTimeout)==null||t(this.state.frame),(o=(e=this.callbacks).after)==null||o.call(e,this.finished),this.state.frame=void 0,this)}},x=class extends p{},q=class extends p{constructor(t,e){super(t,e,1)}};function S(t,e,o,n){return new x(t,e,o,n).start()}function f(t,e){return new q(t,e).start()}var d={active:{capture:!1,passive:!1},passive:{capture:!1,passive:!0}};function m(t,e){let o=typeof e=="string";if(o?t.matches(e):e(t))return t;let n=t==null?void 0:t.parentElement;for(;n!=null;){if(n===document.body)return;if(o?n.matches(e):e(n))break;n=n.parentElement}return n!=null?n:void 0}function g(t){let e=[],o=Array.from(t.querySelectorAll(j()));for(let n of o){let i=getComputedStyle==null?void 0:getComputedStyle(n);(i==null||i.display!=="none"&&i.visibility!=="hidden")&&e.push(n)}return e}function j(){let t=globalThis;return t.focusableSelector==null&&(t.focusableSelector=['[contenteditable]:not([contenteditable="false"])',"[href]","[tabindex]:not(slot)","audio[controls]","button","details","details[open] > summary","embed","iframe","input","object","select","textarea","video[controls]"].map(e=>`${e}:not([disabled]):not([hidden]):not([tabindex="-1"])`).join(",")),t.focusableSelector}function F(t){let{direction:e}=getComputedStyle==null?void 0:getComputedStyle(t);return e==="rtl"?"rtl":"ltr"}function v(t){return(t!=null?t:"").trim().length===0}var I=["above","above-left","above-right","any","below","below-left","below-right","horizontal","horizontal-bottom","horizontal-top","left","left-bottom","left-top","right","right-bottom","right-top","vertical","vertical-left","vertical-right"],N=["bottom","height","left","right","top","width"],$=["left","horizontal","right"],_=["above","any","below","vertical",...$];function G(t,e,o,n){if(t!=="any"){let c=Q(e,t,o);return{top:X(e,t,n),left:c}}let{anchor:i,floater:r}=e,s=y(i.right,i.left,r.width,innerWidth,o),a=y(i.top,i.bottom,r.height,innerHeight,n);return{left:s,top:a}}function y(t,e,o,n,i){let r=e+o,s=t-o;return i?s<0?r>n?s:e:s:r>n?s<0?e:s:e}function J(t,e,o){if(!_.includes(t))return t;let{anchor:n,floater:i}=e,r=$.includes(t),s=r?o.left===n.right?"right":o.left===n.left-i.width?"left":null:o.top===n.bottom?"below":o.top===n.top-i.height?"above":null,a=r?o.top===n.top?"top":o.top===n.bottom-i.height?"bottom":null:o.left===n.left?"left":o.left===n.right-i.width?"right":null;return[s,a].filter(c=>c!=null).join("-")}function Q(t,e,o){let{anchor:n,floater:i}=t;switch(e){case"above":case"below":case"vertical":return n.left+n.width/2-i.width/2;case"above-left":case"below-left":case"vertical-left":return n.left;case"above-right":case"below-right":case"vertical-right":return n.right-i.width;case"horizontal":case"horizontal-bottom":case"horizontal-top":return y(n.left,n.right,i.width,innerWidth,o);case"left":case"left-bottom":case"left-top":return n.left-i.width;case"right":case"right-bottom":case"right-top":return n.right;default:return n.left}}function U(t,e){var i;if(t==null)return e;let o=t.trim().toLowerCase(),n=I.indexOf(o);return n>-1&&(i=I[n])!=null?i:e}function X(t,e,o){let{anchor:n,floater:i}=t;switch(e){case"above":case"above-left":case"above-right":return n.top-i.height;case"horizontal":case"left":case"right":return n.top+n.height/2-i.height/2;case"below":case"below-left":case"below-right":return n.bottom;case"horizontal-bottom":case"left-bottom":case"right-bottom":return n.bottom-i.height;case"horizontal-top":case"left-top":case"right-top":return n.top;case"vertical":case"vertical-left":case"vertical-right":return y(n.top,n.bottom,i.height,innerHeight,o);default:return n.bottom}}function K(t){let{anchor:e,floater:o,parent:n}=t.elements,i=F(o)==="rtl",r,s;function a(){e.insertAdjacentElement("afterend",o)}function c(){var R;let b=U((R=(n!=null?n:e).getAttribute(t.position.attribute))!=null?R:"",t.position.defaultValue),w=e.getBoundingClientRect();if(r===b&&N.every(z=>(s==null?void 0:s[z])===w[z]))return;r=b,s=w;let A={anchor:w,floater:o.getBoundingClientRect()},P=G(b,A,i,t.position.preferAbove),k=`matrix(1, 0, 0, 1, ${P.left}, ${P.top})`;o.style.transform!==k&&(o.style.position="fixed",o.style.inset="0 auto auto 0",o.style.transform=k,o.setAttribute("position",J(b,A,P)))}return document.body.appendChild(o),o.hidden=!1,S(c,0,1/0,a)}var u="formal-focus-trap",E=new WeakMap;function Y(t,e,o){var s;let n=g(e);if(o===e){f(()=>{var a;((a=n[t.shiftKey?n.length-1:0])!=null?a:e).focus()},0);return}let i=n.indexOf(o),r=e;if(i>-1){let a=i+(t.shiftKey?-1:1);a<0?a=n.length-1:a>=n.length&&(a=0),r=(s=n[a])!=null?s:e}f(()=>{r.focus()},0)}function Z(t){for(let e of t){if(e.type!=="attributes")continue;let o=e.target;o.getAttribute(u)==null?h.destroy(o):h.create(o)}}function tt(t){if(t.key!=="Tab")return;let e=t.target,o=m(e,`[${u}]`);o!=null&&(t.preventDefault(),t.stopImmediatePropagation(),Y(t,o,e))}var h=class{constructor(e){l(this,"tabIndex");this.tabIndex=e.tabIndex,e.tabIndex=-1}static create(e){E.has(e)||E.set(e,new h(e))}static destroy(e){let o=E.get(e);o!=null&&(e.tabIndex=o.tabIndex,E.delete(e))}};(()=>{let t=globalThis;if(t.formalFocusTrap!=null)return;t.formalFocusTrap=1,new MutationObserver(Z).observe(document,{attributeFilter:[u],attributeOldValue:!0,attributes:!0,childList:!0,subtree:!0}),f(()=>{let o=Array.from(document.querySelectorAll(`[${u}]`));for(let n of o)n.setAttribute(u,"")},0),document.addEventListener("keydown",tt,d.active)})();var B=new WeakMap,et=0;function C(t,e){var o,n,i;ot(t,e),e&&t.content?((n=(o=g(t.content))==null?void 0:o[0])!=null?n:t.content).focus():(i=t.button)==null||i.focus()}function ot(t,e){let o=B.get(t);if(o==null)return;let n=e?"addEventListener":"removeEventListener";document[n]("click",o.click,d.passive),document[n]("keydown",o.keydown,d.passive)}function D(t,e,o){let{button:n,content:i}=e;if(n==null||i==null)return;let r=m(o,"[polite-popover-content]");if(r==null){M(e,!1);return}t.stopPropagation();let s=Array.from(document.body.children);s.indexOf(r)-s.indexOf(i)<(t instanceof KeyboardEvent?1:0)&&M(e,!1)}function M(t,e){var n,i;let o=typeof e=="boolean"?!e:t.open;t.button.setAttribute("aria-expanded",!o),o?(t.content.hidden=!0,(n=t.timer)==null||n.stop(),C(t,!1)):((i=t.timer)==null||i.stop(),t.timer=K({elements:{anchor:t.button,floater:t.content,parent:t},position:{attribute:"position",defaultValue:"vertical",preferAbove:!1}}),f(()=>{C(t,!0)},50)),t.dispatchEvent(new Event("toggle"))}function nt(t,e,o){o.hidden=!0,v(t.id)&&(t.id=`polite_popover_${++et}`),v(e.id)&&(e.id=`${t.id}_button`),v(o.id)&&(o.id=`${t.id}_content`),e.setAttribute("aria-controls",o.id),e.ariaExpanded="false",e.ariaHasPopup="dialog",e instanceof HTMLButtonElement||(e.tabIndex=0),o.setAttribute(u,""),o.role="dialog",o.ariaModal="false",B.set(t,{click:rt.bind(t),keydown:st.bind(t)}),e.addEventListener("click",L.bind(t),d.passive)}function it(t){return t==null?!1:t instanceof HTMLButtonElement?!0:t instanceof HTMLElement&&t.getAttribute("role")==="button"}function rt(t){this.open&&D(t,this,t.target)}function st(t){this.open&&t instanceof KeyboardEvent&&t.key==="Escape"&&D(t,this,document.activeElement)}function L(t){M(this,t)}var H=class extends HTMLElement{constructor(){super();l(this,"button");l(this,"content");l(this,"timer");let o=this.querySelector(":scope > [polite-popover-button]"),n=this.querySelector(":scope > [polite-popover-content]");if(!it(o))throw new Error("<polite-popover> must have a <button>-element (or button-like element) with the attribute 'polite-popover-button'");if(n==null||!(n instanceof HTMLElement))throw new Error("<polite-popover> must have an element with the attribute 'polite-popover-content'");this.button=o,this.content=n,nt(this,o,n)}get open(){var o;return((o=this.button)==null?void 0:o.getAttribute("aria-expanded"))==="true"}set open(o){L.call(this,o)}toggle(){this.button&&this.content&&L.call(this)}};customElements.define("polite-popover",H);})();
