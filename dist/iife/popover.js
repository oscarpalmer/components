"use strict";(()=>{var q=Object.defineProperty;var B=(t,e,n)=>e in t?q(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var l=(t,e,n)=>(B(t,typeof e!="symbol"?e+"":e,n),n);var x=Math.round(16.666666666666668),O=requestAnimationFrame!=null?requestAnimationFrame:function(t){var e;return(e=setTimeout==null?void 0:setTimeout(()=>{t(Date.now())},x))!=null?e:-1},p=class{constructor(t,e,n,o){l(this,"callbacks");l(this,"configuration");l(this,"state",{active:!1,finished:!1});let i=this instanceof M,r=i?"repeated":"waited";if(typeof t!="function")throw new Error(`A ${r} timer must have a callback function`);if(typeof e!="number"||e<0)throw new Error(`A ${r} timer must have a non-negative number as its time`);if(i&&(typeof n!="number"||n<2))throw new Error("A repeated timer must have a number above 1 as its repeat count");if(i&&o!=null&&typeof o!="function")throw new Error("A repeated timer's after-callback must be a function");this.configuration={count:n,time:e},this.callbacks={after:o,default:t}}get active(){return this.state.active}get finished(){return!this.state.active&&this.state.finished}static run(t){t.state.active=!0,t.state.finished=!1;let e=t instanceof M,n=0,o;function i(r){if(!t.state.active)return;o!=null||(o=r);let a=r-o,s=a-x,c=a+x;if(s<t.configuration.time&&t.configuration.time<c)if(t.state.active&&t.callbacks.default(e?n:void 0),n+=1,e&&n<t.configuration.count)o=void 0;else{t.state.finished=!0,t.stop();return}t.state.frame=O(i)}t.state.frame=O(i)}restart(){return this.stop(),p.run(this),this}start(){return this.state.active||p.run(this),this}stop(){var t,e,n;return this.state.active=!1,typeof this.state.frame=="undefined"?this:((t=cancelAnimationFrame!=null?cancelAnimationFrame:clearTimeout)==null||t(this.state.frame),(n=(e=this.callbacks).after)==null||n.call(e,this.finished),this.state.frame=void 0,this)}},M=class extends p{},j=class extends p{constructor(t,e){super(t,e,1)}};function S(t,e,n,o){return new M(t,e,n,o).start()}function f(t,e){return new j(t,e).start()}var d={active:{capture:!1,passive:!1},passive:{capture:!1,passive:!0}};function g(t,e){let n=typeof e=="string";if(n?t.matches(e):e(t))return t;let o=t==null?void 0:t.parentElement;for(;o!=null;){if(o===document.body)return;if(n?o.matches(e):e(o))break;o=o.parentElement}return o!=null?o:void 0}function v(t){let e=[],n=Array.from(t.querySelectorAll(N()));for(let o of n){let i=getComputedStyle==null?void 0:getComputedStyle(o);(i==null||i.display!=="none"&&i.visibility!=="hidden")&&e.push(o)}return e}function N(){let t=globalThis;return t.focusableSelector==null&&(t.focusableSelector=['[contenteditable]:not([contenteditable="false"])',"[href]","[tabindex]:not(slot)","audio[controls]","button","details","details[open] > summary","embed","iframe","input","object","select","textarea","video[controls]"].map(e=>`${e}:not([disabled]):not([hidden]):not([tabindex="-1"])`).join(",")),t.focusableSelector}function F(t){let{direction:e}=getComputedStyle==null?void 0:getComputedStyle(t);return e==="rtl"?"rtl":"ltr"}function E(t){return(t!=null?t:"").trim().length===0}var I=["above","above-left","above-right","any","below","below-left","below-right","horizontal","horizontal-bottom","horizontal-top","left","left-bottom","left-top","right","right-bottom","right-top","vertical","vertical-left","vertical-right"],_=["bottom","height","left","right","top","width"],C=["left","horizontal","right"],G=["above","any","below","vertical",...C];function J(t,e,n,o){if(t!=="any"){let c=U(e,t,n);return{top:Y(e,t,o),left:c}}let{anchor:i,floater:r}=e,a=y(i.right,i.left,r.width,innerWidth,n),s=y(i.top,i.bottom,r.height,innerHeight,o);return{left:a,top:s}}function y(t,e,n,o,i){let r=e+n,a=t-n;return i?a<0?r>o?a:e:a:r>o?a<0?e:a:e}function Q(t,e,n){if(!G.includes(t))return t;let{anchor:o,floater:i}=e,r=C.includes(t),a=r?n.left===o.right?"right":n.left===o.left-i.width?"left":null:n.top===o.bottom?"below":n.top===o.top-i.height?"above":null,s=r?n.top===o.top?"top":n.top===o.bottom-i.height?"bottom":null:n.left===o.left?"left":n.left===o.right-i.width?"right":null;return[a,s].filter(c=>c!=null).join("-")}function U(t,e,n){let{anchor:o,floater:i}=t;switch(e){case"above":case"below":case"vertical":return o.left+o.width/2-i.width/2;case"above-left":case"below-left":case"vertical-left":return o.left;case"above-right":case"below-right":case"vertical-right":return o.right-i.width;case"horizontal":case"horizontal-bottom":case"horizontal-top":return y(o.left,o.right,i.width,innerWidth,n);case"left":case"left-bottom":case"left-top":return o.left-i.width;case"right":case"right-bottom":case"right-top":return o.right;default:return o.left}}function X(t,e){var i;if(t==null)return e;let n=t.trim().toLowerCase(),o=I.indexOf(n);return o>-1&&(i=I[o])!=null?i:e}function Y(t,e,n){let{anchor:o,floater:i}=t;switch(e){case"above":case"above-left":case"above-right":return o.top-i.height;case"horizontal":case"left":case"right":return o.top+o.height/2-i.height/2;case"below":case"below-left":case"below-right":return o.bottom;case"horizontal-bottom":case"left-bottom":case"right-bottom":return o.bottom-i.height;case"horizontal-top":case"left-top":case"right-top":return o.top;case"vertical":case"vertical-left":case"vertical-right":return y(o.top,o.bottom,i.height,innerHeight,n);default:return o.bottom}}function $(t){let{anchor:e,floater:n,parent:o}=t.elements,i=F(n)==="rtl",r,a;function s(){e.insertAdjacentElement("afterend",n)}function c(){var R;let m=X((R=(o!=null?o:e).getAttribute(t.position.attribute))!=null?R:"",t.position.defaultValue),P=e.getBoundingClientRect();if(r===m&&_.every(z=>(a==null?void 0:a[z])===P[z]))return;r=m,a=P;let A={anchor:P,floater:n.getBoundingClientRect()},T=J(m,A,i,t.position.preferAbove),k=`matrix(1, 0, 0, 1, ${T.left}, ${T.top})`;n.style.transform!==k&&(n.style.position="fixed",n.style.inset="0 auto auto 0",n.style.transform=k,n.setAttribute("position",Q(m,A,T)))}return document.body.appendChild(n),n.hidden=!1,S(c,0,1/0,s)}var u="formal-focus-trap",w=new WeakMap;function Z(t,e,n){var a;let o=v(e);if(n===e){f(()=>{var s;((s=o[t.shiftKey?o.length-1:0])!=null?s:e).focus()},0);return}let i=o.indexOf(n),r=e;if(i>-1){let s=i+(t.shiftKey?-1:1);s<0?s=o.length-1:s>=o.length&&(s=0),r=(a=o[s])!=null?a:e}f(()=>{r.focus()},0)}function tt(t){for(let e of t){if(e.type!=="attributes")continue;let n=e.target;n.getAttribute(u)==null?h.destroy(n):h.create(n)}}function et(t){if(t.key!=="Tab")return;let e=t.target,n=g(e,`[${u}]`);n!=null&&(t.preventDefault(),t.stopImmediatePropagation(),Z(t,n,e))}var h=class{constructor(e){l(this,"tabIndex");this.tabIndex=e.tabIndex,e.tabIndex=-1}static create(e){w.has(e)||w.set(e,new h(e))}static destroy(e){let n=w.get(e);n!=null&&(e.tabIndex=n.tabIndex,w.delete(e))}};(()=>{let t=globalThis;if(t.formalFocusTrap!=null)return;t.formalFocusTrap=1,new MutationObserver(tt).observe(document,{attributeFilter:[u],attributeOldValue:!0,attributes:!0,childList:!0,subtree:!0}),f(()=>{let n=Array.from(document.querySelectorAll(`[${u}]`));for(let o of n)o.setAttribute(u,"")},0),document.addEventListener("keydown",et,d.active)})();var W=new WeakMap,D=new WeakMap,nt=0;function K(t,e){var n,o,i;ot(t,e),e&&t.content?((o=(n=v(t.content))==null?void 0:n[0])!=null?o:t.content).focus():(i=t.button)==null||i.focus()}function ot(t,e){let n=W.get(t),o=D.get(t);if(n==null||o==null)return;let i=e?"addEventListener":"removeEventListener";document[i]("click",n,d.passive),document[i]("keydown",o,d.passive)}function V(t,e,n){let{button:o,content:i}=e;if(o==null||i==null)return;let r=g(n,"[polite-popover-content]");if(r==null){L(e,!1);return}t.stopPropagation();let a=Array.from(document.body.children);a.indexOf(r)-a.indexOf(i)<(t instanceof KeyboardEvent?1:0)&&L(e,!1)}function L(t,e){var o,i;let n=typeof e=="boolean"?!e:t.open;t.button.setAttribute("aria-expanded",!n),n?(t.content.hidden=!0,(o=t.timer)==null||o.stop(),K(t,!1)):((i=t.timer)==null||i.stop(),t.timer=$({elements:{anchor:t.button,floater:t.content,parent:t},position:{attribute:"position",defaultValue:"vertical",preferAbove:!1}}),f(()=>{K(t,!0)},50)),t.dispatchEvent(new Event("toggle"))}function it(t,e,n){n.hidden=!0,E(t.id)&&(t.id=`polite_popover_${++nt}`),E(e.id)&&(e.id=`${t.id}_button`),E(n.id)&&(n.id=`${t.id}_content`),e.setAttribute("aria-controls",n.id),e.ariaExpanded="false",e.ariaHasPopup="dialog",e instanceof HTMLButtonElement||(e.tabIndex=0),n.setAttribute(u,""),n.role="dialog",n.ariaModal="false",W.set(t,rt.bind(t)),D.set(t,at.bind(t)),e.addEventListener("click",H.bind(t),d.passive)}function rt(t){this instanceof b&&this.open&&V(t,this,t.target)}function at(t){this instanceof b&&this.open&&t instanceof KeyboardEvent&&t.key==="Escape"&&V(t,this,document.activeElement)}function H(t){this instanceof b&&L(this,t)}var b=class extends HTMLElement{constructor(){super();l(this,"button");l(this,"content");l(this,"timer");let n=this.querySelector(":scope > [polite-popover-button]"),o=this.querySelector(":scope > [polite-popover-content]");if(n==null||!(n instanceof HTMLButtonElement||n instanceof HTMLElement&&n.getAttribute("role")==="button"))throw new Error("<polite-popover> must have a <button>-element (or button-like element) with the attribute 'polite-popover-button'");if(o==null||!(o instanceof HTMLElement))throw new Error("<polite-popover> must have an element with the attribute 'polite-popover-content'");this.button=n,this.content=o,it(this,n,o)}get open(){var n;return((n=this.button)==null?void 0:n.getAttribute("aria-expanded"))==="true"}set open(n){H.call(this,n)}toggle(){this.button&&this.content&&H.call(this)}};customElements.define("polite-popover",b);})();
