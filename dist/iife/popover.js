"use strict";(()=>{var q=Object.defineProperty;var B=(t,e,n)=>e in t?q(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var l=(t,e,n)=>(B(t,typeof e!="symbol"?e+"":e,n),n);var T=Math.round(16.666666666666668),I=cancelAnimationFrame!=null?cancelAnimationFrame:function(t){clearTimeout==null||clearTimeout(t)},A=requestAnimationFrame!=null?requestAnimationFrame:function(t){var e;return(e=setTimeout==null?void 0:setTimeout(()=>{t(Date.now())},T))!=null?e:-1},p=class{constructor(t,e,n){l(this,"callback");l(this,"count");l(this,"frame");l(this,"running",!1);l(this,"time");let o=this instanceof w,i=o?"repeated":"waited";if(typeof t!="function")throw new Error(`A ${i} timer must have a callback function`);if(typeof e!="number"||e<0)throw new Error(`A ${i} timer must have a non-negative number as its time`);if(o&&(typeof n!="number"||n<2))throw new Error("A repeated timer must have a number above 1 as its repeat count");this.callback=t,this.count=n,this.time=e}get active(){return this.running}static run(t){t.running=!0;let e=0,n;function o(i){if(!t.running)return;n!=null||(n=i);let r=i-n,c=r-T,s=r+T;if(c<t.time&&t.time<s)if(t.running&&t.callback(t instanceof w?e:void 0),e+=1,t instanceof w&&e<t.count)n=void 0;else{t.stop();return}t.frame=A(o)}t.frame=A(o)}restart(){return this.stop(),p.run(this),this}start(){return this.running?this:(p.run(this),this)}stop(){return this.running=!1,typeof this.frame=="undefined"?this:(I(this.frame),this.frame=void 0,this)}},w=class extends p{},z=class extends p{constructor(t,e){super(t,e,1)}};function u(t,e){return new z(t,e).start()}var b={active:{capture:!1,passive:!1},passive:{capture:!1,passive:!0}},j=['[contenteditable]:not([contenteditable="false"])',"[href]","[tabindex]:not(slot)","audio[controls]","button","details","details[open] > summary","embed","iframe","input","object","select","textarea","video[controls]"],D=j.map(t=>`${t}:not([disabled]):not([hidden]):not([tabindex="-1"])`).join(",");function M(t,e,n){Object.defineProperty(t,e,{value:n,writable:!1})}function g(t,e){let n=typeof e=="string";if(n?t.matches(e):e(t))return t;let o=t==null?void 0:t.parentElement;for(;o!=null;){if(o===document.body)return;if(n?o.matches(e):e(o))break;o=o.parentElement}return o!=null?o:void 0}function v(t){var o;let e=[],n=Array.from(t.querySelectorAll(D));for(let i of n){let r=(o=globalThis.getComputedStyle)==null?void 0:o.call(globalThis,i);(r==null||r.display!=="none"&&r.visibility!=="hidden")&&e.push(i)}return e}function E(t){return t==null?!0:t.trim().length===0}function a(t,e,n){n==null?t.removeAttribute(e):t.setAttribute(e,String(n))}function x(t,e,n){t.setAttribute(e,String(typeof n=="boolean"?n:!1))}var O=["above","above-left","above-right","below","below-left","below-right","horizontal","left","right","vertical"],f=class{static update(e,n){let{anchor:o,floater:i,parent:r}=e;function c(){var k;if(i.hidden){o.insertAdjacentElement("afterend",i);return}let s=f.getPosition((k=(r!=null?r:o).getAttribute(n.attribute))!=null?k:"",n.value);i.setAttribute("position",s);let H={anchor:o.getBoundingClientRect(),floater:i.getBoundingClientRect()},K=f.getTop(H,s),W=`matrix(1, 0, 0, 1, ${f.getLeft(H,s)}, ${K})`;i.style.position="fixed",i.style.inset="0 auto auto 0",i.style.transform=W,u(c,0)}document.body.appendChild(i),i.hidden=!1,u(c,0)}static getLeft(e,n){let{left:o,right:i}=e.anchor,{width:r}=e.floater;switch(n){case"above":case"below":case"vertical":return o+e.anchor.width/2-r/2;case"above-left":case"below-left":return o;case"above-right":case"below-right":return i-r;case"horizontal":return i+r>globalThis.innerWidth?o-r<0?i:o-r:i;case"left":return o-r;case"right":return i;default:return 0}}static getTop(e,n){let{bottom:o,top:i}=e.anchor,{height:r}=e.floater;switch(n){case"above":case"above-left":case"above-right":return i-r;case"below":case"below-left":case"below-right":return o;case"horizontal":case"left":case"right":return i+e.anchor.height/2-r/2;case"vertical":return o+r>globalThis.innerHeight?i-r<0?o:i-r:o;default:return 0}}static getPosition(e,n){var r;if(e==null)return n;let o=e.trim().toLowerCase(),i=O.indexOf(o);return i>-1&&(r=O[i])!=null?r:n}};var d="formal-focus-trap",y=new WeakMap;function F(t,e,n){var c;let o=v(e);if(n===e){u(()=>{var s;((s=o[t.shiftKey?o.length-1:0])!=null?s:e).focus()},0);return}let i=o.indexOf(n),r=e;if(i>-1){let s=i+(t.shiftKey?-1:1);s<0?s=o.length-1:s>=o.length&&(s=0),r=(c=o[s])!=null?c:e}u(()=>{r.focus()},0)}function N(t){for(let e of t){if(e.type!=="attributes")continue;let n=e.target;n.getAttribute(d)==null?h.destroy(n):h.create(n)}}function _(t){if(t.key!=="Tab")return;let e=t.target,n=g(e,`[${d}]`);n!=null&&(t.preventDefault(),t.stopImmediatePropagation(),F(t,n,e))}var h=class{constructor(e){l(this,"tabIndex");this.tabIndex=e.tabIndex,a(e,"tabindex","-1")}static create(e){y.has(e)||y.set(e,new h(e))}static destroy(e){let n=y.get(e);n!=null&&(a(e,"tabindex",n.tabIndex),y.delete(e))}};(()=>{if(typeof globalThis._formalFocusTrap!="undefined")return;globalThis._formalFocusTrap=null,new MutationObserver(N).observe(document,{attributeFilter:[d],attributeOldValue:!0,attributes:!0,childList:!0,subtree:!0}),u(()=>{let e=Array.from(document.querySelectorAll(`[${d}]`));for(let n of e)n.setAttribute(d,"")},0),document.addEventListener("keydown",_,b.active)})();var R=new WeakMap,S=new WeakMap,G=0;function C(t,e){var n,o,i;V(t,e),e&&t.content?((o=(n=v(t.content))==null?void 0:n[0])!=null?o:t.content).focus():(i=t.button)==null||i.focus()}function V(t,e){let n=R.get(t),o=S.get(t);if(n==null||o==null)return;let i=e?"addEventListener":"removeEventListener";document[i]("click",n,b.passive),document[i]("keydown",o,b.passive)}function $(t,e,n){let{button:o,content:i}=e;if(o==null||i==null)return;let r=g(n,"[polite-popover-content]");if(r==null){L(e,!1);return}t.stopPropagation();let c=Array.from(document.body.children);c.indexOf(r)-c.indexOf(i)<(t instanceof KeyboardEvent?1:0)&&L(e,!1)}function L(t,e){let n=typeof e=="boolean"?!e:t.open;x(t.button,"aria-expanded",!n),n?(t.content.hidden=!0,C(t,!1)):(f.update({anchor:t.button,floater:t.content,parent:t},{attribute:"position",value:"below-left"}),u(()=>{C(t,!0)},0)),t.dispatchEvent(new Event("toggle"))}function J(t,e,n){n.hidden=!0,E(t.id)&&a(t,"id",`polite_popover_${++G}`),E(e.id)&&a(e,"id",`${t.id}_button`),E(n.id)&&a(n,"id",`${t.id}_content`),a(e,"aria-controls",n.id),x(e,"aria-expanded",!1),a(e,"aria-haspopup","dialog"),e instanceof HTMLButtonElement||a(e,"tabindex","0"),a(n,d,""),a(n,"role","dialog"),a(n,"aria-modal","false"),R.set(t,Q.bind(t)),S.set(t,U.bind(t)),e.addEventListener("click",P.bind(t),b.passive)}function Q(t){this instanceof m&&this.open&&$(t,this,t.target)}function U(t){this instanceof m&&this.open&&t instanceof KeyboardEvent&&t.key==="Escape"&&$(t,this,document.activeElement)}function P(t){this instanceof m&&L(this,t)}var m=class extends HTMLElement{constructor(){super();l(this,"button");l(this,"content");let n=this.querySelector(":scope > [polite-popover-button]"),o=this.querySelector(":scope > [polite-popover-content]");if(n==null||!(n instanceof HTMLButtonElement||n instanceof HTMLElement&&n.getAttribute("role")==="button"))throw new Error("<polite-popover> must have a <button>-element (or button-like element) with the attribute 'polite-popover-button'");if(o==null||!(o instanceof HTMLElement))throw new Error("<polite-popover> must have an element with the attribute 'polite-popover-content'");M(this,"button",n),M(this,"content",o),J(this,n,o)}get open(){var n;return((n=this.button)==null?void 0:n.getAttribute("aria-expanded"))==="true"}set open(n){P.call(this,n)}toggle(){this.button&&this.content&&P.call(this)}};globalThis.customElements.define("polite-popover",m);})();
