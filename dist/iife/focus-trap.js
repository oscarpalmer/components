"use strict";(()=>{var E=Object.defineProperty;var h=(o,t,e)=>t in o?E(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var g=(o,t,e)=>(h(o,typeof t!="symbol"?t+"":t,e),e);var m={active:{capture:!1,passive:!1},passive:{capture:!1,passive:!0}},x=['[contenteditable]:not([contenteditable="false"])',"[href]","[tabindex]:not(slot)","audio[controls]","button","details","details[open] > summary","input","select","textarea","video[controls]"],v=x.map(o=>`${o}:not([disabled]):not([hidden]):not([tabindex="-1"])`).join(",");function c(o){var t,e,n;return(n=(t=globalThis.requestAnimationFrame)==null?void 0:t.call(globalThis,o))!=null?n:(e=globalThis.setTimeout)==null?void 0:e.call(globalThis,()=>{o(Date.now())},16)}function y(o,t){let e=typeof t=="string";if(e?o.matches(t):t(o))return o;let n=o==null?void 0:o.parentElement;for(;n!=null;){if(n===document.body)return;if(e?n.matches(t):t(n))break;n=n.parentElement}return n!=null?n:void 0}function T(o){var n;let t=[],e=Array.from(o.querySelectorAll(v));for(let r of e){let s=(n=globalThis.getComputedStyle)==null?void 0:n.call(globalThis,r);(s==null||s.display!=="none"&&s.visibility!=="hidden")&&t.push(r)}return t}function f(o,t,e){e==null?o.removeAttribute(t):o.setAttribute(t,String(e))}var a="formal-focus-trap",d=new WeakMap,l=class{static observer(t){for(let e of t){if(e.type!=="attributes")continue;let n=e.target;n.getAttribute(a)==null?u.destroy(n):u.create(n)}}static onKeydown(t){if(t.key!=="Tab")return;let e=t.target,n=y(e,`[${a}]`);n!=null&&(t.preventDefault(),t.stopImmediatePropagation(),l.handle(t,n,e))}static handle(t,e,n){var p;let r=T(e);if(n===e){c(()=>{var i;((i=r[t.shiftKey?r.length-1:0])!=null?i:e).focus()});return}let s=r.indexOf(n),b=e;if(s>-1){let i=s+(t.shiftKey?-1:1);i<0?i=r.length-1:i>=r.length&&(i=0),b=(p=r[i])!=null?p:e}c(()=>{b.focus()})}},u=class{constructor(t){g(this,"tabIndex");this.tabIndex=t.tabIndex,f(t,"tabindex","-1")}static create(t){d.has(t)||d.set(t,new u(t))}static destroy(t){let e=d.get(t);e!=null&&(f(t,"tabindex",e.tabIndex),d.delete(t))}};(()=>{if(typeof globalThis._formalFocusTrap!="undefined")return;globalThis._formalFocusTrap=null,new MutationObserver(l.observer).observe(document,{attributeFilter:[a],attributeOldValue:!0,attributes:!0,childList:!0,subtree:!0}),c(()=>{let t=Array.from(document.querySelectorAll(`[${a}]`));for(let e of t)e.setAttribute(a,"")}),document.addEventListener("keydown",l.onKeydown,m.active)})();})();
