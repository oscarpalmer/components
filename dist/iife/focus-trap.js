"use strict";(()=>{var E=Object.defineProperty;var h=(r,t,e)=>t in r?E(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var p=(r,t,e)=>(h(r,typeof t!="symbol"?t+"":t,e),e);var m={active:{capture:!1,passive:!1},passive:{capture:!1,passive:!0}},x=["[href]","[tabindex]","button","input","select","textarea"].map(r=>`${r}:not([disabled]):not([hidden]):not([tabindex="-1"])`).join(",");function c(r){var t,e,n;return(n=(t=globalThis.requestAnimationFrame)==null?void 0:t.call(globalThis,r))!=null?n:(e=globalThis.setTimeout)==null?void 0:e.call(globalThis,()=>{r(Date.now())},16)}function y(r,t){let e=typeof t=="string";if(e?r.matches(t):t(r))return r;let n=r==null?void 0:r.parentElement;for(;n!=null;){if(n===document.body)return;if(e?n.matches(t):t(n))break;n=n.parentElement}return n!=null?n:void 0}function T(r){var n;let t=[],e=Array.from(r.querySelectorAll(x));for(let o of e){let s=(n=globalThis.getComputedStyle)==null?void 0:n.call(globalThis,o);(s==null||s.display!=="none"&&s.visibility!=="hidden")&&t.push(o)}return t}function f(r,t,e){e==null?r.removeAttribute(t):r.setAttribute(t,String(e))}var a="formal-focus-trap",d=new WeakMap,u=class{static observer(t){for(let e of t){if(e.type!=="attributes")continue;let n=e.target;n.getAttribute(a)==null?l.destroy(n):l.create(n)}}static onKeydown(t){if(t.key!=="Tab")return;let e=t.target,n=y(e,`[${a}]`);n!=null&&(t.preventDefault(),t.stopImmediatePropagation(),u.handle(t,n,e))}static handle(t,e,n){var g;let o=T(e);if(n===e){c(()=>{var i;((i=o[t.shiftKey?o.length-1:0])!=null?i:e).focus()});return}let s=o.indexOf(n),b=e;if(s>-1){let i=s+(t.shiftKey?-1:1);i<0?i=o.length-1:i>=o.length&&(i=0),b=(g=o[i])!=null?g:e}c(()=>{b.focus()})}},l=class{constructor(t){p(this,"tabIndex");this.tabIndex=t.tabIndex,f(t,"tabindex","-1")}static create(t){d.has(t)||d.set(t,new l(t))}static destroy(t){let e=d.get(t);e!=null&&(f(t,"tabindex",e.tabIndex),d.delete(t))}};(()=>{if(typeof globalThis._formalFocusTrap!="undefined")return;globalThis._formalFocusTrap=null,new MutationObserver(u.observer).observe(document,{attributeFilter:[a],attributeOldValue:!0,attributes:!0,childList:!0,subtree:!0}),c(()=>{let t=Array.from(document.querySelectorAll(`[${a}]`));for(let e of t)e.setAttribute(a,"")}),document.addEventListener("keydown",u.onKeydown,m.active)})();})();
