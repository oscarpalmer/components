"use strict";var M=Object.defineProperty;var w=(l,e,t)=>e in l?M(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var g=(l,e,t)=>(w(l,typeof e!="symbol"?e+"":e,t),t);var E={active:{capture:!1,passive:!1},passive:{capture:!1,passive:!0}};function L(l){var e;return(e=requestAnimationFrame==null?void 0:requestAnimationFrame(l))!=null?e:setTimeout==null?void 0:setTimeout(()=>{l(Date.now())},16)}function T(l,e){let t=l==null?void 0:l.parentElement;for(;t!=null;){if(t===document.body)return;if(e(t))break;t=t.parentElement}return t!=null?t:void 0}var H=["[href]","[tabindex]","button","input","select","textarea"].map(l=>`${l}:not([disabled]):not([hidden]):not([tabindex="-1"])`).join(",");var r=class{static getChildren(e){return Array.from(e.querySelectorAll(":scope > delicious-details > details, :scope > details"))}static onKeydown(e){var c;if(e.isComposing||e.key!=="ArrowDown"&&e.key!=="ArrowUp"||!(this instanceof y))return;let{target:t}=e;if(!(t instanceof HTMLElement))return;let n=(c=a.list.children.get(this))!=null?c:[],i=t.parentElement,u=n.indexOf(i);if(u===-1)return;let s=u+(e.key==="ArrowDown"?1:-1);s<0?s=n.length-1:s>=n.length&&(s=0);let d=n[s],f=d==null?void 0:d.querySelector(":scope > summary");f==null||f.focus()}static onKeyup(e){if(e.key!=="Escape")return;let{containers:t}=a.details,n=T(document.activeElement,i=>{var u,s;return t.has(i)&&((s=(u=t.get(i))==null?void 0:u.open)!=null?s:!0)});n instanceof m&&r.onToggle.call(n,!1)}static onToggle(e){var u;if(!(this instanceof m))return;let{buttons:t,containers:n}=a.details,i=n.get(this);i!=null&&(i.open=e!=null?e:!i.open,i.open||(u=t.get(this))==null||u.focus())}static open(e,t){if(t==null)return;if(t.length>0&&!/^[\s\d,]+$/.test(t))throw new Error("The 'selected'-attribute of a 'delicious-details-list'-element must be a comma-separated string of numbers, e.g. '', '0' or '0,1,2'");let n=t.length>0?t.split(",").filter(i=>i.trim().length>0).map(i=>Number.parseInt(i,10)):[];r.update(e,n)}static update(e,t){var f,c;if(typeof t=="undefined")return;let{children:n,observer:i,open:u}=a.list,s=t.filter((o,p,b)=>b.indexOf(o)===p).sort((o,p)=>o-p);if(e.multiple||(s=s.length>0&&s[0]!=null?s.length>1?[s[0]]:s:[]),s.every((o,p)=>e.open[p]===o))return;(f=i.get(e))==null||f.disconnect();let d=(c=n.get(e))!=null?c:[];for(let o of d)s.includes(d.indexOf(o))!==o.open&&(o.open=!o.open);u.set(e,s),L(()=>{s.length===0?e.removeAttribute("open"):e.setAttribute("open",s.join(",")),L(()=>{var o;return(o=i.get(e))==null?void 0:o.observe(e,h.options)})})}},h=class{static callback(e,t){var p,b,D;if(t.length===0)return;let{children:n}=a.list,i=t[0],u=Array.from((p=i==null?void 0:i.addedNodes)!=null?p:[]),s=Array.from((b=i==null?void 0:i.removedNodes)!=null?b:[]);if(u.concat(s).some(v=>v.parentElement===e)){n.set(e,r.getChildren(e));return}if((i==null?void 0:i.type)!=="attributes"||!((i==null?void 0:i.target)instanceof HTMLDetailsElement))return;let d=i.target,c=((D=n.get(e))!=null?D:[]).indexOf(d);if(c===-1)return;let o=[];e.multiple?o=d.open?e.open.concat([c]):e.open.filter(v=>v!==c):o=d.open?[c]:[],r.update(e,o)}};g(h,"options",{attributeFilter:["open"],attributes:!0,childList:!0,subtree:!0});var a=class{};g(a,"details",{buttons:new WeakMap,containers:new WeakMap}),g(a,"list",{children:new WeakMap,observer:new WeakMap,open:new WeakMap});var m=class extends HTMLElement{close(){r.onToggle.call(this,!1)}connectedCallback(){let e=this.querySelector(":scope > details"),t=e==null?void 0:e.querySelector(":scope > summary");a.details.buttons.set(this,t),a.details.containers.set(this,e)}disconnectedCallback(){a.details.buttons.delete(this),a.details.containers.delete(this)}open(){r.onToggle.call(this,!0)}toggle(){r.onToggle.call(this)}},y=class extends HTMLElement{static get observedAttributes(){return["multiple","open"]}get multiple(){return this.getAttribute("multiple")!=null}set multiple(e){e?this.setAttribute("multiple",""):this.removeAttribute("multiple")}get open(){var e;return(e=a.list.open.get(this))!=null?e:[]}set open(e){r.update(this,e)}attributeChangedCallback(e,t,n){var i;if(t!==n)switch(e){case"multiple":r.open(this,(i=this.getAttribute("open"))!=null?i:void 0);break;case"open":r.open(this,n);break;default:break}}connectedCallback(){var i,u;let{children:e,observer:t,open:n}=a.list;e.set(this,r.getChildren(this)),n.set(this,[]),t.set(this,new MutationObserver(s=>{h.callback(this,s)})),(i=t.get(this))==null||i.observe(this,h.options),this.addEventListener("keydown",r.onKeydown.bind(this),E.passive),r.open(this,(u=this.getAttribute("open"))!=null?u:void 0)}disconnectedCallback(){var i;let{children:e,observer:t,open:n}=a.list;e.delete(this),(i=t.get(this))==null||i.disconnect(),t.delete(this),n.delete(this)}};addEventListener==null||addEventListener("keyup",r.onKeyup,E.passive);customElements==null||customElements.define("delicious-details",m);customElements==null||customElements.define("delicious-details-list",y);
