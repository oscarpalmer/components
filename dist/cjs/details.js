"use strict";var k=Object.defineProperty;var H=(l,e,t)=>e in l?k(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var m=(l,e,t)=>(H(l,typeof e!="symbol"?e+"":e,t),t);var L={active:{capture:!1,passive:!1},passive:{capture:!1,passive:!0}},A=["[href]","[tabindex]","button","input","select","textarea"].map(l=>`${l}:not([disabled]):not([hidden]):not([tabindex="-1"])`).join(",");function v(l){var e;return(e=requestAnimationFrame==null?void 0:requestAnimationFrame(l))!=null?e:setTimeout==null?void 0:setTimeout(()=>{l(Date.now())},16)}function M(l,e){let t=l==null?void 0:l.parentElement;for(;t!=null;){if(t===document.body)return;if(e(t))break;t=t.parentElement}return t!=null?t:void 0}function D(l,e,t){let n=l.getAttribute(e);return n==null||n.trim().length===0?t:n}function w(l,e,t){typeof t=="undefined"?l.removeAttribute(e):l.setAttribute(e,String(t))}var o=class{static getChildren(e){return Array.from(e.querySelectorAll(":scope > delicious-details > details, :scope > details"))}static initializeList(e){var s;let{children:t,connected:n,observer:i,open:u}=r.list;n.set(e),t.set(e,o.getChildren(e)),u.set(e,[]),i.set(e,new MutationObserver(d=>{b.callback(e,d)})),(s=i.get(e))==null||s.observe(e,b.options),e.addEventListener("keydown",o.onLocalKeydown.bind(e),L.passive),o.open(e,D(e,"open",""))}static onGlobalKeydown(e){if(e.key!=="Escape")return;let{containers:t}=r.details,n=M(document.activeElement,i=>{var u,s;return t.has(i)&&((s=(u=t.get(i))==null?void 0:u.open)!=null?s:!0)});n instanceof g&&o.onToggle.call(n,!1)}static onLocalKeydown(e){var f;if(e.isComposing||e.key!=="ArrowDown"&&e.key!=="ArrowUp"||!(this instanceof y))return;let{target:t}=e;if(!(t instanceof HTMLElement))return;let n=(f=r.list.children.get(this))!=null?f:[],i=t.parentElement,u=n.indexOf(i);if(u===-1)return;let s=u+(e.key==="ArrowDown"?1:-1);s<0?s=n.length-1:s>=n.length&&(s=0);let d=n[s],p=d==null?void 0:d.querySelector(":scope > summary");p==null||p.focus()}static onToggle(e){var u;if(!(this instanceof g))return;let{buttons:t,containers:n}=r.details,i=n.get(this);typeof i!="undefined"&&(i.open=e!=null?e:!i.open,i.open||(u=t.get(this))==null||u.focus())}static open(e,t){if(t.length>0&&!/^[\s\d,]+$/.test(t))throw new Error("The 'selected'-attribute of a 'delicious-details-list'-element must be a comma-separated string of numbers, e.g. '', '0' or '0,1,2'");let n=t.length>0?t.split(",").filter(i=>i.trim().length>0).map(i=>Number.parseInt(i,10)):[];o.update(e,n)}static update(e,t){var p,f;if(typeof t=="undefined")return;let{children:n,observer:i,open:u}=r.list,s=t.filter((a,c,h)=>h.indexOf(a)===c).sort((a,c)=>a-c);if(e.multiple||(s=s.length>0&&s[0]!=null?s.length>1?[s[0]]:s:[]),s.every((a,c)=>e.open[c]===a))return;(p=i.get(e))==null||p.disconnect();let d=(f=n.get(e))!=null?f:[];for(let a of d)s.includes(d.indexOf(a))!==a.open&&(a.open=!a.open);u.set(e,s),v(()=>{let a=e.open!==s;w(e,"open",s.length===0?null:s),a&&e.dispatchEvent(new Event("toggle")),v(()=>{var c;return(c=i.get(e))==null?void 0:c.observe(e,b.options)})})}},b=class{static callback(e,t){var c,h,T;if(t.length===0)return;let{children:n}=r.list,i=t[0],u=Array.from((c=i==null?void 0:i.addedNodes)!=null?c:[]),s=Array.from((h=i==null?void 0:i.removedNodes)!=null?h:[]);if(u.concat(s).some(E=>E.parentElement===e)){n.set(e,o.getChildren(e));return}if((i==null?void 0:i.type)!=="attributes"||!((i==null?void 0:i.target)instanceof HTMLDetailsElement))return;let d=i.target,f=((T=n.get(e))!=null?T:[]).indexOf(d);if(f===-1)return;let a=[];e.multiple?a=d.open?e.open.concat([f]):e.open.filter(E=>E!==f):a=d.open?[f]:[],o.update(e,a)}};m(b,"options",{attributeFilter:["open"],attributes:!0,childList:!0,subtree:!0});var r=class{};m(r,"details",{buttons:new WeakMap,connected:new WeakMap,containers:new WeakMap}),m(r,"list",{children:new WeakMap,connected:new WeakMap,observer:new WeakMap,open:new WeakMap});var g=class extends HTMLElement{get open(){var e,t;return(t=(e=r.details.containers.get(this))==null?void 0:e.open)!=null?t:!1}set open(e){o.onToggle.call(this,e)}connectedCallback(){if(r.details.connected.has(this))return;let e=this.querySelector(":scope > details"),t=e==null?void 0:e.querySelector(":scope > summary");r.details.connected.set(this),r.details.buttons.set(this,t),r.details.containers.set(this,e)}toggle(){o.onToggle.call(this)}},y=class extends HTMLElement{static get observedAttributes(){return["multiple","open"]}get multiple(){return this.getAttribute("multiple")!=null}set multiple(e){w(this,"multiple",e?"":null)}get open(){var e;return(e=r.list.open.get(this))!=null?e:[]}set open(e){o.update(this,e)}attributeChangedCallback(e,t,n){if(t!==n)switch(e){case"multiple":o.open(this,D(this,"open",""));break;case"open":o.open(this,n);break;default:break}}connectedCallback(){r.list.connected.has(this)||o.initializeList(this)}};addEventListener==null||addEventListener("keydown",o.onGlobalKeydown,L.passive);customElements==null||customElements.define("delicious-details",g);customElements==null||customElements.define("delicious-details-list",y);
