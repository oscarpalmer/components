"use strict";var w=Object.defineProperty;var P=(l,e,t)=>e in l?w(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var y=(l,e,t)=>(P(l,typeof e!="symbol"?e+"":e,t),t);var E={active:{capture:!1,passive:!1},passive:{capture:!1,passive:!0}};function f(l){var e;return(e=requestAnimationFrame==null?void 0:requestAnimationFrame(l))!=null?e:setTimeout==null?void 0:setTimeout(()=>{l(Date.now())},16)}var L=["[href]","[tabindex]","button","input","select","textarea"].map(l=>`${l}:not([disabled]):not([hidden]):not([tabindex="-1"])`).join(",");function g(l){var n;let e=[],t=Array.from(l.querySelectorAll(L));for(let i of t){let o=(n=window==null?void 0:window.getComputedStyle)==null?void 0:n.call(window,i);(o==null||o.display!=="none"&&o.visibility!=="hidden")&&e.push(i)}return e}function k(){return URL.createObjectURL(new Blob).replace(/^.*\/([\w-]+)$/,"$1").replace(/-/g,"_")}var x=["any"].concat(...["above","below"].map(l=>[l,`${l}-left`,`${l}-right`])),s=class{static onClick(e){var i;if(!(this instanceof v))return;let{button:t,content:n}=r.getElements(this);t==null||n==null||t.getAttribute("aria-expanded")!=="true"||e.target!==t&&e.target!==n&&!((i=n==null?void 0:n.contains(e.target))!=null&&i)&&s.toggle.call(this,!1)}static onKeydown(e){var u;if(!(this instanceof v)||!(e instanceof KeyboardEvent))return;let{button:t,content:n}=r.getElements(this);if(t==null||n==null||t.getAttribute("aria-expanded")!=="true"||(e.key==="Escape"&&s.toggle.call(this,!1),e.key!=="Tab"))return;e.preventDefault();let i=g(n);if(document.activeElement===n){f(()=>{var a;((a=i[e.shiftKey?i.length-1:0])!=null?a:n).focus()});return}let o=i.indexOf(document.activeElement),c=n;if(o>-1){let a=o+(e.shiftKey?-1:1);a<0?a=i.length-1:a>=i.length&&(a=0),c=(u=i[a])!=null?u:n}f(()=>{c.focus()})}static setCoordinates(e,t){e.style.inset="0 auto auto 0",e.style.position="fixed",e.style.transform=`translate3d(${t.x}px, ${t.y}px, 0)`}static toggle(e){var a,d;if(!(this instanceof v))return;let{button:t,content:n}=r.getElements(this);if(t==null||n==null)return;let i=typeof e=="boolean"?!e:t.getAttribute("aria-expanded")==="true",{click:o,keydown:c}=r.getCallbacks(this),u=i?"removeEventListener":"addEventListener";o!=null&&document[u]("click",o,E.passive),c!=null&&document[u]("keydown",c,E.active),i?(a=n.parentElement)==null||a.removeChild(n):document.body.appendChild(n),t.setAttribute("aria-expanded",String(!i)),(i?t:(d=g(n)[0])!=null?d:n).focus(),s.update(this)}static getCoordinates(e,t,n){let{bottom:i,left:o,right:c,top:u}=t.getBoundingClientRect(),{height:a,width:d}=n.getBoundingClientRect(),m=0,b=0;if(e.includes("above"))b=u-a;else if(e.includes("below"))b=i;else{let h=i+a,p=u-a;b=h>window.innerHeight?p<0?i:p:i}if(e.includes("left"))m=o;else if(e.includes("right"))m=c-d;else{let h=o+d,p=c-d;m=h>window.innerWidth?p<0?o:p:o}return{x:m,y:b}}static getPosition(e){let t=e.getAttribute("position"),n=t==null?void 0:t.trim().toLowerCase();return n!=null&&x.includes(n)?n:"below"}static update(e){let{button:t,content:n}=r.getElements(e);if(t==null||n==null)return;function i(){if((t==null?void 0:t.getAttribute("aria-expanded"))!=="true"||n==null)return;let o=s.getPosition(e),c=s.getCoordinates(o,t,n);s.setCoordinates(n,c),f(i)}f(i)}},r=class{static getCallbacks(e){return{click:this.values.click.get(e),keydown:this.values.keydown.get(e)}}static getElements(e){return{button:this.values.buttons.get(e),content:this.values.content.get(e)}}static remove(e){this.values.buttons.delete(e),this.values.click.delete(e),this.values.content.delete(e),this.values.keydown.delete(e)}static setCallbacks(e){var t,n;(t=this.values.click)==null||t.set(e,s.onClick.bind(e)),(n=this.values.keydown)==null||n.set(e,s.onKeydown.bind(e))}static setElements(e,t,n){var i,o;(i=this.values.buttons)==null||i.set(e,t),(o=this.values.content)==null||o.set(e,n)}};y(r,"values",{buttons:new WeakMap,click:new WeakMap,content:new WeakMap,keydown:new WeakMap});var v=class extends HTMLElement{close(){s.toggle.call(this,!1)}connectedCallback(){var n;let e=this.querySelector(":scope > [polite-popover-button]"),t=this.querySelector(":scope > [polite-popover-content]");if(e==null)throw new Error("a");if(!(e instanceof HTMLButtonElement)&&e.getAttribute("role")!=="button")throw new Error("b");if(t==null)throw new Error("c");(n=t.parentElement)==null||n.removeChild(t),t.id||t.setAttribute("id",k()),s.setCoordinates(t,{x:-1e5,y:-1e5}),e.setAttribute("aria-controls",t.id),e.setAttribute("aria-expanded","false"),t.setAttribute("tabindex","-1"),r.setElements(this,e,t),r.setCallbacks(this),e.addEventListener("click",s.toggle.bind(this),E.passive)}disconnectedCallback(){r.remove(this)}open(){s.toggle.call(this,!0)}toggle(){s.toggle.call(this)}};customElements==null||customElements.define("polite-popover",v);
